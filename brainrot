local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local basePos = nil
local moving = false
local flyHeight = 300 -- altura para sobrevolar paredes
local speed = 35

local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.Name = "SkyFlyTP"
gui.ResetOnSpawn = false

local saveBtn = Instance.new("TextButton", gui)
saveBtn.Size = UDim2.new(0, 160, 0, 40)
saveBtn.Position = UDim2.new(0, 20, 0, 100)
saveBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
saveBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
saveBtn.Text = "ðŸ“ Guardar Base"
saveBtn.Font = Enum.Font.SourceSansBold
saveBtn.TextSize = 18
saveBtn.Parent = gui

local tpBtn = Instance.new("TextButton", gui)
tpBtn.Size = UDim2.new(0, 160, 0, 40)
tpBtn.Position = UDim2.new(0, 20, 0, 150)
tpBtn.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
tpBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
tpBtn.Text = "ðŸš€ Volar sobre paredes"
tpBtn.Font = Enum.Font.SourceSansBold
tpBtn.TextSize = 18
tpBtn.Parent = gui

gui.Parent = player:WaitForChild("PlayerGui")

-- Forzar Noclip
RunService.Stepped:Connect(function()
    if moving then
        local char = player.Character
        if char then
            for _, part in ipairs(char:GetDescendants()) do
                if part:IsA("BasePart") and part.CanCollide then
                    part.CanCollide = false
                end
            end
        end
    end
end)

-- Guardar base
saveBtn.MouseButton1Click:Connect(function()
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if hrp then
        basePos = hrp.Position
        saveBtn.Text = "âœ… Base Guardada"
        wait(1.5)
        saveBtn.Text = "ðŸ“ Guardar Base"
    end
end)

-- Subida, vuelo horizontal, caÃ­da
tpBtn.MouseButton1Click:Connect(function()
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not basePos or not hrp then
        tpBtn.Text = "âŒ No hay base"
        wait(1.5)
        tpBtn.Text = "ðŸš€ Volar sobre paredes"
        return
    end

    moving = true
    tpBtn.Text = "ðŸ›« Elevando..."

    -- 1. Elevar
    local targetAbove = hrp.Position + Vector3.new(0, flyHeight, 0)
    while (hrp.Position - targetAbove).Magnitude > 5 do
        hrp.CFrame = hrp.CFrame + Vector3.new(0, speed, 0)
        wait(0.02)
    end

    -- 2. Volar horizontal
    tpBtn.Text = "ðŸ›¸ Volando..."
    local horizontalTarget = Vector3.new(basePos.X, hrp.Position.Y, basePos.Z)
    while (hrp.Position - horizontalTarget).Magnitude > 5 do
        local dir = (horizontalTarget - hrp.Position).Unit
        hrp.CFrame = hrp.CFrame + dir * speed
        wait(0.02)
    end

    -- 3. Caer
    tpBtn.Text = "ðŸª‚ Descendiendo..."
    local finalTarget = basePos + Vector3.new(0, 5, 0)
    while (hrp.Position - finalTarget).Magnitude > 5 do
        hrp.CFrame = hrp.CFrame - Vector3.new(0, speed, 0)
        wait(0.02)
    end

    moving = false
    tpBtn.Text = "âœ… Llegaste"
    wait(1.5)
    tpBtn.Text = "ðŸš€ Volar sobre paredes"
end)
